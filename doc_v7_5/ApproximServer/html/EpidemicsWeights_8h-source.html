<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Approxsim: EpidemicsWeights.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>EpidemicsWeights.h</h1><div class="fragment"><pre>00001 
00010 <span class="preprocessor">#ifndef APPROXSIM_EPIDEMICSWEIGHTS_H</span>
00011 <span class="preprocessor"></span><span class="preprocessor">#define APPROXSIM_EPIDEMICSWEIGHTS_H</span>
00012 <span class="preprocessor"></span>
00013 <span class="comment">// System</span>
00014 <span class="preprocessor">#include &lt;cmath&gt;</span>
00015 
00016 <span class="comment">// Own</span>
00017 <span class="preprocessor">#include "<a class="code" href="GoodStuff_8h.html">GoodStuff.h</a>"</span>
00018 
00019 
<a name="l00020"></a><a class="code" href="classEpidemicsWeights.html">00020</a> <span class="keyword">class </span><a class="code" href="classEpidemicsWeights.html">EpidemicsWeights</a> {
00021 <span class="keyword">private</span>:
00023      <span class="keyword">static</span> <span class="keywordtype">int</span>     <a class="code" href="classEpidemicsWeights.html#v0">mRows</a>;
00025      <span class="keyword">static</span> <span class="keywordtype">int</span>     <a class="code" href="classEpidemicsWeights.html#v1">mCols</a>;
00027      <span class="keyword">static</span> <span class="keywordtype">int</span>     <a class="code" href="classEpidemicsWeights.html#v2">mHalfNumberOfCells</a>;
00029      <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="classEpidemicsWeights.html#v3">mCellSideMeters</a>;
00031      <span class="keyword">static</span> <span class="keywordtype">double</span> *<a class="code" href="classEpidemicsWeights.html#v4">mEpidemicsWeight</a>;
00032 
00033 <span class="keyword">public</span>:
00035      <span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classEpidemicsWeights.html#e0">setEpidemicsWeights</a>(<span class="keywordtype">double</span> meanContact, <span class="keywordtype">double</span> maxContact, <span class="keywordtype">double</span> cellSideMeters,
00036                                             <span class="keywordtype">int</span> nrows, <span class="keywordtype">int</span> ncols);
00037 
00040      <span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span>   <a class="code" href="classEpidemicsWeights.html#e1">limits</a>(<span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col, <span class="keywordtype">int</span> &amp;top, <span class="keywordtype">int</span> &amp;left, <span class="keywordtype">int</span> &amp;bottom, <span class="keywordtype">int</span> &amp;right);
00041 
<a name="l00044"></a><a class="code" href="classEpidemicsWeights.html#e2">00044</a>      <span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="classEpidemicsWeights.html#e2">weight</a>(<span class="keywordtype">int</span> i) { <span class="keywordflow">return</span> <a class="code" href="classEpidemicsWeights.html#v4">mEpidemicsWeight</a>[i]; }
00045 
<a name="l00047"></a><a class="code" href="classEpidemicsWeights.html#e3">00047</a>      <span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span>   <a class="code" href="classEpidemicsWeights.html#e3">clear</a>() { <span class="keywordflow">if</span> (<a class="code" href="classEpidemicsWeights.html#v4">mEpidemicsWeight</a>) { <span class="keyword">delete</span> [] <a class="code" href="classEpidemicsWeights.html#v4">mEpidemicsWeight</a>; <a class="code" href="classEpidemicsWeights.html#v4">mEpidemicsWeight</a> = 0; } }
00048 };
00049 
<a name="l00050"></a><a class="code" href="classEpidemicsWeights.html#e0">00050</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEpidemicsWeights.html#e0">EpidemicsWeights::setEpidemicsWeights</a>(<span class="keywordtype">double</span> meanContact, <span class="keywordtype">double</span> maxContact, <span class="keywordtype">double</span> cellSideMeters, <span class="keywordtype">int</span> nrows, <span class="keywordtype">int</span> ncols)
00051 {
00052      <a class="code" href="classEpidemicsWeights.html#v0">mRows</a> = nrows;
00053      <a class="code" href="classEpidemicsWeights.html#v1">mCols</a> = ncols;
00054      <a class="code" href="classEpidemicsWeights.html#v2">mHalfNumberOfCells</a> = <a class="code" href="GoodStuff_8h.html#a12">Round</a>(maxContact / cellSideMeters);
00055      <a class="code" href="classEpidemicsWeights.html#v3">mCellSideMeters</a> = cellSideMeters;
00056 
00057      <span class="keywordtype">int</span> dr2, dc, midRow, midCol;
00058      <span class="keywordtype">int</span> top, left, bottom, right;
00059      <span class="keywordtype">double</span> lambdaInv;
00060      
00061      midRow     = <a class="code" href="classEpidemicsWeights.html#v0">mRows</a> / 2;
00062      midCol     = <a class="code" href="classEpidemicsWeights.html#v1">mCols</a> / 2;
00063      lambdaInv  = 1 / meanContact;
00064      
00065      <a class="code" href="classEpidemicsWeights.html#e1">limits</a>(midRow, midCol, top, left, bottom, right);
00066      
00067      <span class="keywordflow">if</span> (<a class="code" href="classEpidemicsWeights.html#v4">mEpidemicsWeight</a>) {
00068           <span class="keyword">delete</span> [] <a class="code" href="classEpidemicsWeights.html#v4">mEpidemicsWeight</a>;
00069      }
00070 
00071      <a class="code" href="classEpidemicsWeights.html#v4">mEpidemicsWeight</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[(bottom - top + 1) * (right - left + 1)];
00072      
00073      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = top; r &lt;= bottom; r++ ) {
00074           dr2 = (midRow - r) * (midRow - r);
00075           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = left; c &lt;= right; c++ ) {
00076                dc = midCol - c;
00077                <span class="keywordflow">if</span> ( dr2 || dc ) {                       
00078                     <a class="code" href="classEpidemicsWeights.html#v4">mEpidemicsWeight</a>[c - left + (r - top) * (right - left + 1)] = 
00079                          exp( -(sqrt(static_cast&lt;double&gt;(dr2+dc*dc)) * <a class="code" href="classEpidemicsWeights.html#v3">mCellSideMeters</a>) * lambdaInv ) * lambdaInv;
00080                }
00081                <span class="keywordflow">else</span> {
00082                     <a class="code" href="classEpidemicsWeights.html#v4">mEpidemicsWeight</a>[c - left + (r - top) * (right - left + 1)] = 0;
00083                }
00084           }
00085      }
00086 }
00087 
<a name="l00088"></a><a class="code" href="classEpidemicsWeights.html#e1">00088</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEpidemicsWeights.html#e1">EpidemicsWeights::limits</a>(<span class="keywordtype">int</span> row, <span class="keywordtype">int</span> col, <span class="keywordtype">int</span> &amp;top, <span class="keywordtype">int</span> &amp;left, <span class="keywordtype">int</span> &amp;bottom, <span class="keywordtype">int</span> &amp;right ) {
00089      top    = std::max(         0, row - <a class="code" href="classEpidemicsWeights.html#v2">mHalfNumberOfCells</a> );
00090      left   = std::max(         0, col - <a class="code" href="classEpidemicsWeights.html#v2">mHalfNumberOfCells</a> );
00091      bottom = std::min( <a class="code" href="classEpidemicsWeights.html#v0">mRows</a> - 1, row + <a class="code" href="classEpidemicsWeights.html#v2">mHalfNumberOfCells</a> );
00092      right  = std::min( <a class="code" href="classEpidemicsWeights.html#v1">mCols</a> - 1, col + <a class="code" href="classEpidemicsWeights.html#v2">mHalfNumberOfCells</a> );
00093 }
00094 
00095 <span class="preprocessor">#endif   // APPROXSIM_EPIDEMICSWEIGHTS_H</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Jan 31 14:27:32 2007 for Approxsim by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>
