<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Approxsim: GridCell.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>GridCell.h</h1><div class="fragment"><pre>00001 <span class="preprocessor">#ifndef APPROXSIM_GRIDCELL_H</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#define APPROXSIM_GRIDCELL_H</span>
00003 <span class="preprocessor"></span>
00004 <span class="comment">// System</span>
00005 <span class="preprocessor">#include &lt;vector&gt;</span>
00006 
00007 <span class="comment">// Own</span>
00008 <span class="preprocessor">#include "debugheader.h"</span>
00009 <span class="preprocessor">#include "<a class="code" href="GoodStuff_8h.html">GoodStuff.h</a>"</span>
00010 <span class="preprocessor">#include "LatLng.h"</span>
00011 <span class="preprocessor">#include "ProcessVariables.h"</span>
00012 <span class="preprocessor">#include "Region.h"</span>
00013 
00014 
00015 <span class="comment">// Forward Declarations</span>
00016 <span class="keyword">class </span><a class="code" href="classCity.html">City</a>;
00017 <span class="keyword">class </span><a class="code" href="classEthnicFaction.html">EthnicFaction</a>;
00018 <span class="keyword">class </span><a class="code" href="classGrid.html">Grid</a>;
00019 <span class="keyword">class </span><a class="code" href="classRegion.html">Region</a>;
00020 
00021 
00023 <span class="keyword">enum</span> eNeighbor {
00024      eN,
00025      eNE,
00026      eE,
00027      eSE,
00028      eS,
00029      eSW,
00030      eW,
00031      eNW,
00032      eNumNeighbors
00033 };
00034 
00035 
00036 
<a name="l00043"></a><a class="code" href="classGridCell.html">00043</a> <span class="keyword">class </span><a class="code" href="classGridCell.html">GridCell</a> {
00044 <span class="keyword">private</span>:
00045      <span class="keyword">static</span> <span class="keywordtype">int</span> sFactions;
00046      <span class="keyword">static</span> <span class="keywordtype">double</span> sCellAreaKm2;
00047 
<a name="l00048"></a><a class="code" href="classGridCell.html#r0">00048</a>      <a class="code" href="classGrid.html">Grid</a>&amp;       <a class="code" href="classGridCell.html#r0">mGrid</a>;       
<a name="l00049"></a><a class="code" href="classGridCell.html#r1">00049</a>      <span class="keywordtype">int</span>         <a class="code" href="classGridCell.html#r1">mIndex</a>;      
<a name="l00050"></a><a class="code" href="classGridCell.html#r2">00050</a>      <span class="keywordtype">int</span>         <a class="code" href="classGridCell.html#r2">mPos</a>;        
<a name="l00051"></a><a class="code" href="classGridCell.html#r3">00051</a>      <span class="keywordtype">int</span>         <a class="code" href="classGridCell.html#r3">mRow</a>;        
<a name="l00052"></a><a class="code" href="classGridCell.html#r4">00052</a>      <span class="keywordtype">int</span>         <a class="code" href="classGridCell.html#r4">mCol</a>;        
<a name="l00053"></a><a class="code" href="classGridCell.html#r5">00053</a>      <a class="code" href="classGridCell.html">GridCell</a>**  <a class="code" href="classGridCell.html#r5">mNeighbor</a>;   
<a name="l00054"></a><a class="code" href="classGridCell.html#r6">00054</a>      <a class="code" href="classLatLng.html">LatLng</a>      <a class="code" href="classGridCell.html#r6">mCenter</a>;     
00055 
<a name="l00057"></a><a class="code" href="classGridCell.html#r7">00057</a>      std::vector&lt;const Region*&gt; <a class="code" href="classGridCell.html#r7">mRegions</a>;
00058 
00059      <span class="keywordtype">int</span> mReadInd;
00060      <span class="keywordtype">int</span> mWriteInd;
00061 
00062      <span class="keywordtype">double</span>** mPVF[2];
00063      <span class="keywordtype">double</span>* mPV[2];
00064      <span class="keywordtype">double</span>* mPreCalcF;
00065      <span class="keywordtype">double</span>* mPreCalc;
00066      <span class="keywordtype">double</span>* mDerivedF;
00067      <span class="keywordtype">double</span>* mDerived;
00068 
00069      <span class="keywordtype">double</span> mWellWaterFraction;
00070 
00071      <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classGridCell.html#d0">position</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>* corner);
00072 
00073      <span class="keyword">inline</span> <span class="keywordtype">double</span> pvrGet(eRegionPV pvr);
00074      <span class="keyword">inline</span> <span class="keywordtype">double</span> regionParam(eRegionParameter param);
00075      <span class="keyword">inline</span> <span class="keywordtype">double</span> regionPVFGet(ePVF pvf, <span class="keywordtype">int</span> f = 0);
00076 
00077      <span class="keyword">inline</span> <span class="keywordtype">void</span> doPopulation(<span class="keywordtype">double</span>* data);
00078      <span class="keyword">inline</span> <span class="keywordtype">void</span> doDisplaced(<span class="keywordtype">double</span>* data);
00079      <span class="keyword">inline</span> <span class="keywordtype">void</span> doSheltered(<span class="keywordtype">double</span>* data);
00080      <span class="keyword">inline</span> <span class="keywordtype">void</span> doViolence(<span class="keywordtype">double</span>* data);
00081      <span class="keyword">inline</span> <span class="keywordtype">void</span> doPerceivedThreat(<span class="keywordtype">double</span>* data);
00082      <span class="keyword">inline</span> <span class="keywordtype">void</span> doInsurgents(<span class="keywordtype">double</span>* data);
00083      <span class="keyword">inline</span> <span class="keywordtype">void</span> doEthnicTension(<span class="keywordtype">double</span>* data);
00084      <span class="keyword">inline</span> <span class="keywordtype">void</span> doFractionCrimeVictims(<span class="keywordtype">double</span>* data);
00085      <span class="keyword">inline</span> <span class="keywordtype">void</span> doHousingUnits(<span class="keywordtype">double</span>* data);
00086      <span class="keyword">inline</span> <span class="keywordtype">void</span> doStoredFood(<span class="keywordtype">double</span>* data);
00087      <span class="keyword">inline</span> <span class="keywordtype">void</span> doFoodConsumption(<span class="keywordtype">double</span>* data);
00088      <span class="keyword">inline</span> <span class="keywordtype">void</span> doFarmStoredFood(<span class="keywordtype">double</span>* data);
00089      <span class="keyword">inline</span> <span class="keywordtype">void</span> doMarketedFood(<span class="keywordtype">double</span>* data);
00090      <span class="keyword">inline</span> <span class="keywordtype">void</span> doFoodDays(<span class="keywordtype">double</span>* data);
00091      <span class="keyword">inline</span> <span class="keywordtype">void</span> doWaterConsumption(<span class="keywordtype">double</span>* data);
00092      <span class="keyword">inline</span> <span class="keywordtype">void</span> doWaterDays(<span class="keywordtype">double</span>* data);
00093      <span class="keyword">inline</span> <span class="keywordtype">void</span> doSusceptible(<span class="keywordtype">double</span>* data);
00094      <span class="keyword">inline</span> <span class="keywordtype">void</span> doInfected(<span class="keywordtype">double</span>* data);
00095      <span class="keyword">inline</span> <span class="keywordtype">void</span> doRecovered(<span class="keywordtype">double</span>* data);
00096      <span class="keyword">inline</span> <span class="keywordtype">void</span> doDeadDueToDisease(<span class="keywordtype">double</span>* data);
00097      <span class="keyword">inline</span> <span class="keywordtype">void</span> doFractionInfected(<span class="keywordtype">double</span>* data);
00098      <span class="keyword">inline</span> <span class="keywordtype">void</span> doFractionRecovered(<span class="keywordtype">double</span>* data);
00099      <span class="keyword">inline</span> <span class="keywordtype">void</span> doFractionNoWork(<span class="keywordtype">double</span>* data);
00100 
00101      <span class="keyword">inline</span> <span class="keywordtype">void</span> doProtected(<span class="keywordtype">double</span>* data);
00102      <span class="keyword">inline</span> <span class="keywordtype">void</span> doFractionNoMedical(<span class="keywordtype">double</span>* data) { doNothing(eFractionNoMedical); }
00103      <span class="keyword">inline</span> <span class="keywordtype">void</span> doFractionNoFood(<span class="keywordtype">double</span>* data);
00104      <span class="keyword">inline</span> <span class="keywordtype">void</span> doSuppliedWater(<span class="keywordtype">double</span>* data) { doNothing(eSuppliedWater); }
00105      <span class="keyword">inline</span> <span class="keywordtype">void</span> doFractionNoWater(<span class="keywordtype">double</span>* data);
00106      <span class="keyword">inline</span> <span class="keywordtype">void</span> doInfrastructure(<span class="keywordtype">double</span>* data);
00107 
00108      <span class="keyword">inline</span> <span class="keywordtype">void</span> doTEST(<span class="keywordtype">double</span>* data);
00109 
00110      <span class="keyword">inline</span> <span class="keywordtype">void</span> doDDisaffection(<span class="keywordtype">double</span>* data);
00111      <span class="keyword">inline</span> <span class="keywordtype">void</span> doDPolarization(<span class="keywordtype">double</span>* data);
00112      <span class="keyword">inline</span> <span class="keywordtype">void</span> doDHoused(<span class="keywordtype">double</span>* data);
00113      <span class="keyword">inline</span> <span class="keywordtype">void</span> doDAvailableFood(<span class="keywordtype">double</span>* data);
00114      <span class="keyword">inline</span> <span class="keywordtype">void</span> doDFoodDeprivation(<span class="keywordtype">double</span>* data);
00115      <span class="keyword">inline</span> <span class="keywordtype">void</span> doDWaterSurplusDeficit(<span class="keywordtype">double</span>* data);
00116      <span class="keyword">inline</span> <span class="keywordtype">void</span> doDWaterDeprivation(<span class="keywordtype">double</span>* data);
00117 
00118      <span class="keyword">inline</span> <span class="keywordtype">void</span> doNothingF(ePVF pv) { memcpy(mPVF[mWriteInd][pv], mPVF[mReadInd][pv], (sFactions + 1) * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)); }
00119      <span class="keyword">inline</span> <span class="keywordtype">void</span> doNothing(ePV pv) { mPV[mWriteInd][pv] = mPV[mReadInd][pv]; }
00120 
00121      <span class="keywordtype">void</span> exposePercent(<span class="keywordtype">double</span>* data, <span class="keyword">const</span> <a class="code" href="classEthnicFaction.html">EthnicFaction</a>&amp; fac, <span class="keywordtype">double</span> size);
00122      <span class="keywordtype">void</span> exposeDisplaced(<span class="keywordtype">double</span>* data, <span class="keyword">const</span> <a class="code" href="classEthnicFaction.html">EthnicFaction</a>&amp; fac, <span class="keywordtype">double</span> size);
00123      <span class="keywordtype">void</span> exposeSheltered(<span class="keywordtype">double</span>* data, <span class="keyword">const</span> <a class="code" href="classEthnicFaction.html">EthnicFaction</a>&amp; fac, <span class="keywordtype">double</span> size);
00124      <span class="keywordtype">void</span> exposeProtected(<span class="keywordtype">double</span>* data, <span class="keyword">const</span> <a class="code" href="classEthnicFaction.html">EthnicFaction</a>&amp; fac, <span class="keywordtype">double</span> size);
00125      <span class="keywordtype">void</span> exposeInsurgents(<span class="keywordtype">double</span>* data, <span class="keyword">const</span> <a class="code" href="classEthnicFaction.html">EthnicFaction</a>&amp; fac, <span class="keywordtype">double</span> size);
00126 
00127      <span class="keywordtype">void</span> exposeFraction(<span class="keywordtype">double</span>* data, <span class="keywordtype">double</span> size);
00128      <span class="keywordtype">void</span> exposeFoodDays(<span class="keywordtype">double</span>* data, <span class="keywordtype">double</span> size);
00129      <span class="keywordtype">void</span> exposeWaterDays(<span class="keywordtype">double</span>* data, <span class="keywordtype">double</span> size);
00130      <span class="keywordtype">void</span> exposeFractionInfected(<span class="keywordtype">double</span>* data, <span class="keywordtype">double</span> size);
00131      <span class="keywordtype">void</span> exposeFractionRecovered(<span class="keywordtype">double</span>* data, <span class="keywordtype">double</span> size);
00132 
00133 <span class="keyword">public</span>:
00134      <a class="code" href="classGridCell.html#a0">GridCell</a>(<a class="code" href="classGrid.html">Grid</a>&amp; g, <span class="keywordtype">int</span> activeIndex, <span class="keyword">const</span> <span class="keywordtype">double</span>* corners, <span class="keywordtype">int</span> nGrp);
00135      <a class="code" href="classGridCell.html#a1">~GridCell</a>();
00136 
<a name="l00142"></a><a class="code" href="classGridCell.html#e0">00142</a>      <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classGridCell.html#e0">setNumberOfFactions</a>(<span class="keywordtype">int</span> num) { sFactions = num; }
00143 
<a name="l00149"></a><a class="code" href="classGridCell.html#a2">00149</a>      <span class="keywordtype">int</span> <a class="code" href="classGridCell.html#a2">index</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classGridCell.html#r1">mIndex</a>; }
00150 
<a name="l00156"></a><a class="code" href="classGridCell.html#a3">00156</a>      <span class="keywordtype">int</span> <a class="code" href="classGridCell.html#a3">pos</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classGridCell.html#r2">mPos</a>; }
00157 
<a name="l00163"></a><a class="code" href="classGridCell.html#a4">00163</a>      <span class="keywordtype">int</span> <a class="code" href="classGridCell.html#a4">row</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classGridCell.html#r3">mRow</a>; }
00164 
<a name="l00170"></a><a class="code" href="classGridCell.html#a5">00170</a>      <span class="keywordtype">int</span> <a class="code" href="classGridCell.html#a5">col</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classGridCell.html#r4">mCol</a>; }
00171 
00172      <span class="keyword">static</span> <span class="keywordtype">double</span> areaKm2() { <span class="keywordflow">return</span> sCellAreaKm2; }
00173 
<a name="l00179"></a><a class="code" href="classGridCell.html#a6">00179</a>      <a class="code" href="classLatLng.html">LatLng</a> <a class="code" href="classGridCell.html#a6">center</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classGridCell.html#r6">mCenter</a>; }
00180 
<a name="l00189"></a><a class="code" href="classGridCell.html#a7">00189</a>      <span class="keywordtype">double</span> <a class="code" href="classGridCell.html#a7">squDistanceTo</a>(<span class="keyword">const</span> <a class="code" href="classGridCell.html">GridCell</a>&amp; g)<span class="keyword"> const   </span>{ <span class="keywordflow">return</span> <a class="code" href="classGridCell.html#r6">mCenter</a>.<a class="code" href="classLatLng.html#a7">squDistanceTo</a>(g.<a class="code" href="classGridCell.html#r6">mCenter</a>); }
00190 
<a name="l00198"></a><a class="code" href="classGridCell.html#a8">00198</a>      <a class="code" href="classGridCell.html">GridCell</a>* <a class="code" href="classGridCell.html#a8">neighbor</a>(<span class="keywordtype">int</span> i) { <span class="keywordflow">return</span> <a class="code" href="classGridCell.html#r5">mNeighbor</a>[i]; };
00199 
<a name="l00206"></a><a class="code" href="classGridCell.html#a9">00206</a>      <span class="keywordtype">void</span> <a class="code" href="classGridCell.html#a9">setNeighbor</a>(<a class="code" href="classGridCell.html">GridCell</a>* cell, eNeighbor dir) { <a class="code" href="classGridCell.html#r5">mNeighbor</a>[dir] = cell; }
<a name="l00210"></a><a class="code" href="classGridCell.html#a10">00210</a>      <span class="keywordtype">void</span> <a class="code" href="classGridCell.html#a10">makeCalculatedTSCurrentTS</a>() { mReadInd = !mReadInd; mWriteInd = !mWriteInd; }
00211 
00212      <span class="keywordtype">void</span> addOverlappingRegion(<span class="keyword">const</span> <a class="code" href="classRegion.html">Region</a>&amp; r) { <a class="code" href="classGridCell.html#r7">mRegions</a>.push_back(&amp;r); }
00213      <span class="keywordtype">int</span> numOverlappingRegions()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classGridCell.html#r7">mRegions</a>.size(); }
00214 
00215      <span class="keywordtype">void</span> <a class="code" href="classGridCell.html#a13">init</a>();
00216      <span class="keywordtype">void</span> <a class="code" href="classGridCell.html#a14">update</a>();
00217      <span class="keywordtype">void</span> <a class="code" href="classGridCell.html#a15">expose</a>(eAllPV pv, <span class="keyword">const</span> <a class="code" href="classEthnicFaction.html">EthnicFaction</a>&amp; faction, <span class="keywordtype">double</span> size);
00218      <span class="keywordtype">void</span> <a class="code" href="classGridCell.html#a16">adjustValues</a>();
00219      <span class="keywordtype">void</span> <a class="code" href="classGridCell.html#a17">handleRoundOffErrors</a>();
00220 
00221      <span class="keyword">friend</span> std::ostream&amp; <a class="code" href="classGridCell.html#a0">operator &lt;&lt; </a>(std::ostream&amp; o, <span class="keyword">const</span> <a class="code" href="classGridCell.html">GridCell</a>&amp; c);
00222 
<a name="l00228"></a><a class="code" href="classGridCell.html#a18">00228</a>      <span class="keywordtype">int</span> <a class="code" href="classGridCell.html#a18">dailyShots</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0; }
00229 
<a name="l00235"></a><a class="code" href="classGridCell.html#a19">00235</a>      <span class="keywordtype">double</span> <a class="code" href="classGridCell.html#a19">smoothedShots</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0; }
00236 
00237      <span class="keywordtype">double</span> weight()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 1.0 / static_cast&lt;double&gt;(<a class="code" href="classGridCell.html#r7">mRegions</a>.size()); }
00238 
00239      <span class="keywordtype">double</span> pvfGet(ePVF pv, <span class="keywordtype">int</span> f = 0)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mPVF[mReadInd][pv][f]; }
00240      <span class="keywordtype">void</span> pvfSet(ePVF pv, <span class="keywordtype">int</span> f, <span class="keywordtype">double</span> value) { mPVF[mWriteInd][pv][f] = value; }
00241      <span class="keywordtype">void</span> pvfSetR(ePVF pv, <span class="keywordtype">int</span> f, <span class="keywordtype">double</span> value) { mPVF[mReadInd][pv][f] = value; }
00242      <span class="keywordtype">void</span> pvfAdd(ePVF pv, <span class="keywordtype">int</span> f, <span class="keywordtype">double</span> value) { mPVF[mWriteInd][pv][f] += value; }
00243      <span class="keywordtype">void</span> pvfAddR(ePVF pv, <span class="keywordtype">int</span> f, <span class="keywordtype">double</span> value) { mPVF[mReadInd][pv][f] += value; }
00244 
00245      <span class="keywordtype">double</span> pvGet(ePV pv)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mPV[mReadInd][pv]; }
00246      <span class="keywordtype">void</span> pvSet(ePV pv, <span class="keywordtype">double</span> value) { mPV[mWriteInd][pv] = value; }
00247      <span class="keywordtype">void</span> pvSetR(ePV pv, <span class="keywordtype">double</span> value) { mPV[mReadInd][pv] = value; }
00248      <span class="keywordtype">void</span> pvAdd(ePV pv, <span class="keywordtype">double</span> value) { mPV[mWriteInd][pv] += value; }
00249      <span class="keywordtype">void</span> pvAddR(ePV pv, <span class="keywordtype">double</span> value) { mPV[mReadInd][pv] += value; }
00250 
00251 
00252      <span class="keywordtype">double</span> pdfGet(eDerivedF pv, <span class="keywordtype">int</span> f = 0)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mDerivedF[pv * (sFactions + 1)  + f]; }
00253      <span class="keywordtype">void</span> pdfSet(eDerivedF pv, <span class="keywordtype">int</span> f, <span class="keywordtype">double</span> value) { mDerivedF[pv * (sFactions + 1)  + f] = value; }
00254      <span class="keywordtype">void</span> pdfAdd(eDerivedF pv, <span class="keywordtype">int</span> f, <span class="keywordtype">double</span> value) { mDerivedF[pv * (sFactions + 1)  + f] += value; }
00255      <span class="keywordtype">void</span> pdfReset() { memset(mDerivedF, 0, eDNumDerivedF * (sFactions + 1) * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)); }
00256 
00257      <span class="keywordtype">double</span> pdGet(eDerived pv)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mDerived[pv]; }
00258      <span class="keywordtype">void</span> pdSet(eDerived pv, <span class="keywordtype">double</span> value) { mDerived[pv] = value; }
00259      <span class="keywordtype">void</span> pdAdd(eDerived pv, <span class="keywordtype">double</span> value) { mDerived[pv] += value; }
00260      <span class="keywordtype">void</span> pdReset() { memset(mDerived, 0, eDNumDerived * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)); }
00261 
00262 
00263      <span class="keywordtype">double</span> pcfGet(ePreCalcF pv, <span class="keywordtype">int</span> f = 0)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mPreCalcF[pv * (sFactions + 1)  + f]; }
00264      <span class="keywordtype">void</span> pcfSet(ePreCalcF pv, <span class="keywordtype">int</span> f, <span class="keywordtype">double</span> value) { mPreCalcF[pv * (sFactions + 1)  + f] = value; }
00265      <span class="keywordtype">void</span> pcfAdd(ePreCalcF pv, <span class="keywordtype">int</span> f, <span class="keywordtype">double</span> value) { mPreCalcF[pv * (sFactions + 1)  + f] += value; }
00266      <span class="keywordtype">void</span> pcfReset() { memset(mPreCalcF, 0, ePNumPreCalcF * (sFactions + 1) * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)); }
00267 
00268      <span class="keywordtype">double</span> pcGet(ePreCalc pv)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mPreCalc[pv]; }
00269      <span class="keywordtype">void</span> pcSet(ePreCalc pv, <span class="keywordtype">double</span> value) { mPreCalc[pv] = value; }
00270      <span class="keywordtype">void</span> pcAdd(ePreCalc pv, <span class="keywordtype">double</span> value) { mPreCalc[pv] += value; }
00271      <span class="keywordtype">void</span> pcReset() { memset(mPreCalc, 0, ePNumPreCalc * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)); }
00272 
00273      <span class="keywordtype">void</span> <a class="code" href="classGridCell.html#a47">pvAllSet</a>(eAllPV pv, <span class="keywordtype">int</span> f, <span class="keywordtype">double</span> value);
00274      <span class="keywordtype">void</span> <a class="code" href="classGridCell.html#a48">pvAllSetR</a>(eAllPV pv, <span class="keywordtype">int</span> f, <span class="keywordtype">double</span> value);
00275 
00276      <span class="keywordtype">void</span> <a class="code" href="classGridCell.html#a49">recalculateAllFaction</a>();
00277      <span class="keywordtype">void</span> <a class="code" href="classGridCell.html#a50">setSumR</a>(ePVF pv);
00278      <span class="keywordtype">void</span> <a class="code" href="classGridCell.html#a51">setPopulationWeightedAverageR</a>(ePVF pv);
00279 
00280      <span class="keywordtype">void</span> doDerived();
00281      <span class="keywordtype">void</span> doPrecalculated();
00282 
00283      <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> handleRoundOffErrorsPositive(<span class="keywordtype">double</span>* data, <span class="keywordtype">int</span> size = 1);
00284      <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> handleRoundOffErrorsPercent(<span class="keywordtype">double</span>* data, <span class="keywordtype">int</span> size = 1);
00285      <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> handleRoundOffErrorsFraction(<span class="keywordtype">double</span>* data, <span class="keywordtype">int</span> size = 1);
00286 
00287      <span class="keywordtype">double</span> popDensity()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> pvfGet(ePopulation, 0) / sCellAreaKm2; }
00288      <span class="keywordtype">double</span> bestFoodStorage() <span class="keyword">const</span>;
00289      <span class="keywordtype">double</span> bestWaterCapacity() <span class="keyword">const</span>;
00290      <span class="keywordtype">double</span> expectedTension() <span class="keyword">const</span>;
00291      std::ostream&amp; print2(std::ostream&amp; o);
00292      std::vector&lt;const Region*&gt; regions()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classGridCell.html#r7">mRegions</a>; }
00293 };
00294 
<a name="l00305"></a><a class="code" href="structlessGridCellPtr.html">00305</a> <span class="keyword">struct </span><a class="code" href="structlessGridCellPtr.html">lessGridCellPtr</a> {
<a name="l00314"></a><a class="code" href="structlessGridCellPtr.html#a0">00314</a>      <span class="keywordtype">bool</span> <a class="code" href="structlessGridCellPtr.html#a0">operator()</a>(<span class="keyword">const</span> <a class="code" href="classGridCell.html">GridCell</a>* c1, <span class="keyword">const</span> <a class="code" href="classGridCell.html">GridCell</a>* c2) {
00315           <span class="keywordflow">return</span> (c1-&gt;<a class="code" href="classGridCell.html#a4">row</a>() &lt; c2-&gt;<a class="code" href="classGridCell.html#a4">row</a>() || c1-&gt;<a class="code" href="classGridCell.html#a4">row</a>() == c2-&gt;<a class="code" href="classGridCell.html#a4">row</a>() &amp;&amp; c1-&gt;<a class="code" href="classGridCell.html#a5">col</a>() &lt; c2-&gt;<a class="code" href="classGridCell.html#a5">col</a>());
00316      }
00317 };
00318 
<a name="l00328"></a><a class="code" href="structequalGridCellPtr.html">00328</a> <span class="keyword">struct </span><a class="code" href="structequalGridCellPtr.html">equalGridCellPtr</a> {
<a name="l00336"></a><a class="code" href="structequalGridCellPtr.html#a0">00336</a>      <span class="keywordtype">bool</span> <a class="code" href="structequalGridCellPtr.html#a0">operator()</a>(<span class="keyword">const</span> <a class="code" href="classGridCell.html">GridCell</a>* c1, <span class="keyword">const</span> <a class="code" href="classGridCell.html">GridCell</a>* c2) {
00337           <span class="keywordflow">return</span> (c1-&gt;<a class="code" href="classGridCell.html#a4">row</a>() == c2-&gt;<a class="code" href="classGridCell.html#a4">row</a>() &amp;&amp; c1-&gt;<a class="code" href="classGridCell.html#a5">col</a>() == c2-&gt;<a class="code" href="classGridCell.html#a5">col</a>());
00338      }
00339 };
00340 
00341 
00342 <span class="keywordtype">void</span> GridCell::handleRoundOffErrorsPositive(<span class="keywordtype">double</span>* data, <span class="keywordtype">int</span> size)
00343 {
00344      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; size; i++) {
00345           data[i] = std::max(0.0, data[i]);
00346      }
00347 }
00348 
00349 <span class="keywordtype">void</span> GridCell::handleRoundOffErrorsPercent(<span class="keywordtype">double</span>* data, <span class="keywordtype">int</span> size)
00350 {
00351      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; size; i++) {
00352           data[i] = <a class="code" href="GoodStuff_8h.html#a14">between</a>(data[i], 0.0, 100.0);
00353      }
00354 }
00355 
00356 <span class="keywordtype">void</span> GridCell::handleRoundOffErrorsFraction(<span class="keywordtype">double</span>* data, <span class="keywordtype">int</span> size)
00357 {
00358      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; size; i++) {
00359           data[i] = <a class="code" href="GoodStuff_8h.html#a14">between</a>(data[i], 0.0, 1.0);
00360      }
00361 }
00362 
00363 
00364 <span class="preprocessor">#endif   // APPROXSIM_GRIDCELL_H</span>
00365 <span class="preprocessor"></span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Jan 31 14:27:32 2007 for Approxsim by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>
